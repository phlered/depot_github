<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tangente √† une courbe - Animation interactive</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
            background-color: #f0f0f0;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        #canvas {
            border: 2px solid #333;
            background-color: white;
            cursor: crosshair;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .info {
            margin-top: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-width: 600px;
        }
        .info p {
            margin: 8px 0;
            font-size: 16px;
        }
        .value {
            color: #0066cc;
            font-weight: bold;
        }
        .instruction {
            margin-top: 15px;
            padding: 10px;
            background-color: #e8f4f8;
            border-left: 4px solid #0066cc;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>Tangente √† une courbe : f(x) = x¬≥ - 3x + 1</h1>
    <canvas id="canvas" width="800" height="600"></canvas>
    
    <div class="info">
        <p><strong>Point sur la courbe :</strong> A(<span class="value" id="xValue">0.00</span> ; <span class="value" id="yValue">0.00</span>)</p>
        <p><strong>Nombre d√©riv√© :</strong> f'(<span class="value" id="xDerivValue">0.00</span>) = <span class="value" id="derivValue">0.00</span></p>
        <p><strong>√âquation de la tangente :</strong> y = <span class="value" id="equation">...</span></p>
        <div class="instruction">
            üí° D√©placez la souris sur le graphique pour voir la tangente √† diff√©rents points de la courbe.
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Configuration
        const width = canvas.width;
        const height = canvas.height;
        const centerX = width / 2;
        const centerY = height / 2;
        const scale = 60; // pixels par unit√©
        
        // Fonction et sa d√©riv√©e
        function f(x) {
            return x * x * x - 3 * x + 1;
        }
        
        function fPrime(x) {
            return 3 * x * x - 3;
        }
        
        // Conversion coordonn√©es math√©matiques <-> canvas
        function mathToCanvas(x, y) {
            return {
                x: centerX + x * scale,
                y: centerY - y * scale
            };
        }
        
        function canvasToMath(canvasX, canvasY) {
            return {
                x: (canvasX - centerX) / scale,
                y: (centerY - canvasY) / scale
            };
        }
        
        // Position actuelle de la souris
        let mouseX = 0;
        let currentX = 0;
        
        // Dessiner la grille
        function drawGrid() {
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            // Lignes verticales
            for (let x = -10; x <= 10; x++) {
                const pos = mathToCanvas(x, 0);
                ctx.beginPath();
                ctx.moveTo(pos.x, 0);
                ctx.lineTo(pos.x, height);
                ctx.stroke();
            }
            
            // Lignes horizontales
            for (let y = -10; y <= 10; y++) {
                const pos = mathToCanvas(0, y);
                ctx.beginPath();
                ctx.moveTo(0, pos.y);
                ctx.lineTo(width, pos.y);
                ctx.stroke();
            }
        }
        
        // Dessiner les axes
        function drawAxes() {
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            
            // Axe X
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(width, centerY);
            ctx.stroke();
            
            // Axe Y
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, height);
            ctx.stroke();
            
            // Graduations et labels
            ctx.fillStyle = '#000';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            
            for (let x = -6; x <= 6; x++) {
                if (x !== 0) {
                    const pos = mathToCanvas(x, 0);
                    ctx.fillText(x.toString(), pos.x, centerY + 20);
                    // Marque de graduation
                    ctx.beginPath();
                    ctx.moveTo(pos.x, centerY - 5);
                    ctx.lineTo(pos.x, centerY + 5);
                    ctx.stroke();
                }
            }
            
            ctx.textAlign = 'right';
            for (let y = -5; y <= 5; y++) {
                if (y !== 0) {
                    const pos = mathToCanvas(0, y);
                    ctx.fillText(y.toString(), centerX - 10, pos.y + 5);
                    // Marque de graduation
                    ctx.beginPath();
                    ctx.moveTo(centerX - 5, pos.y);
                    ctx.lineTo(centerX + 5, pos.y);
                    ctx.stroke();
                }
            }
            
            // Labels des axes
            ctx.fillText('O', centerX - 15, centerY + 20);
            ctx.textAlign = 'center';
            ctx.fillText('x', width - 20, centerY + 20);
            ctx.fillText('y', centerX + 20, 20);
        }
        
        // Dessiner la courbe
        function drawCurve() {
            ctx.strokeStyle = '#0066cc';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            let firstPoint = true;
            for (let x = -6.5; x <= 6.5; x += 0.01) {
                const y = f(x);
                const pos = mathToCanvas(x, y);
                
                if (firstPoint) {
                    ctx.moveTo(pos.x, pos.y);
                    firstPoint = false;
                } else {
                    ctx.lineTo(pos.x, pos.y);
                }
            }
            
            ctx.stroke();
        }
        
        // Dessiner la tangente
        function drawTangent(x0) {
            const y0 = f(x0);
            const slope = fPrime(x0);
            
            // Couleur selon le signe de la d√©riv√©e
            if (slope > 0.1) {
                ctx.strokeStyle = '#00aa00'; // Vert pour croissante
            } else if (slope < -0.1) {
                ctx.strokeStyle = '#cc0000'; // Rouge pour d√©croissante
            } else {
                ctx.strokeStyle = '#0066cc'; // Bleu pour horizontale
            }
            
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            
            // Dessiner la tangente sur toute la largeur
            const xMin = -7;
            const xMax = 7;
            const yMin = slope * (xMin - x0) + y0;
            const yMax = slope * (xMax - x0) + y0;
            
            const posMin = mathToCanvas(xMin, yMin);
            const posMax = mathToCanvas(xMax, yMax);
            
            ctx.moveTo(posMin.x, posMin.y);
            ctx.lineTo(posMax.x, posMax.y);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Dessiner le point
            const pos = mathToCanvas(x0, y0);
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.arc(pos.x, pos.y, 6, 0, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.stroke();
        }
        
        // Mettre √† jour l'affichage des informations
        function updateInfo(x) {
            const y = f(x);
            const derivative = fPrime(x);
            
            document.getElementById('xValue').textContent = x.toFixed(2);
            document.getElementById('yValue').textContent = y.toFixed(2);
            document.getElementById('xDerivValue').textContent = x.toFixed(2);
            document.getElementById('derivValue').textContent = derivative.toFixed(2);
            
            // √âquation de la tangente : y = f'(x0)(x - x0) + f(x0)
            const b = y - derivative * x;
            let equation = '';
            
            if (Math.abs(derivative) < 0.01) {
                equation = `${y.toFixed(2)}`;
            } else if (Math.abs(b) < 0.01) {
                equation = `${derivative.toFixed(2)}x`;
            } else if (b > 0) {
                equation = `${derivative.toFixed(2)}x + ${b.toFixed(2)}`;
            } else {
                equation = `${derivative.toFixed(2)}x - ${Math.abs(b).toFixed(2)}`;
            }
            
            document.getElementById('equation').textContent = equation;
        }
        
        // Fonction principale de rendu
        function draw() {
            ctx.clearRect(0, 0, width, height);
            
            drawGrid();
            drawAxes();
            drawCurve();
            drawTangent(currentX);
            updateInfo(currentX);
        }
        
        // Gestion des √©v√©nements de la souris
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            const canvasX = e.clientX - rect.left;
            const mathCoords = canvasToMath(canvasX, 0);
            
            // Limiter x √† l'intervalle visible
            currentX = Math.max(-6, Math.min(6, mathCoords.x));
            draw();
        });
        
        // Gestion du toucher pour mobile
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            const canvasX = touch.clientX - rect.left;
            const mathCoords = canvasToMath(canvasX, 0);
            
            currentX = Math.max(-6, Math.min(6, mathCoords.x));
            draw();
        });
        
        // Initialisation
        currentX = 1;
        draw();
    </script>
</body>
</html>
